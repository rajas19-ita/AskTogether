{% load static %}

<article class="at-answer">
    <aside class="at-answer__side">
        {% include 'ask_together/components/vote_block.html' with type='answer' id=ctx.answer.id total_votes=ctx.total_votes  user_vote=ctx.user_vote user=ctx.user %}
        {% if ctx.can_accept_answer %}
            <button id="answer{{ctx.answer.id}}_acc_btn" class="at-btn at-btn-plain" onClick="handleAcceptedAnswer({{ctx.answer.id}}, this)">
                <svg data-accepted='false'  xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="40" height="40" viewBox="0 0 20 20" class="text-secondary text-opacity-50 {% if ctx.is_accepted %} d-none {% endif %}">
                    <path d="M8.294 16.998c-.435 0-.847-.203-1.111-.553L3.61 11.724a1.392 1.392 0 0 1 .27-1.951 1.392 1.392 0 0 1 1.953.27l2.351 3.104 5.911-9.492a1.396 1.396 0 0 1 1.921-.445c.653.406.854 1.266.446 1.92L9.478 16.34a1.39 1.39 0 0 1-1.12.656c-.022.002-.042.002-.064.002z"/>
                </svg>
                <svg data-accepted='true' xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="40" height="40" viewBox="0 0 20 20" class="text-success {% if not ctx.is_accepted %} d-none {% endif %}">
                    <path d="M8.294 16.998c-.435 0-.847-.203-1.111-.553L3.61 11.724a1.392 1.392 0 0 1 .27-1.951 1.392 1.392 0 0 1 1.953.27l2.351 3.104 5.911-9.492a1.396 1.396 0 0 1 1.921-.445c.653.406.854 1.266.446 1.92L9.478 16.34a1.39 1.39 0 0 1-1.12.656c-.022.002-.042.002-.064.002z"/>
                </svg>
            </button>
        {% elif ctx.is_accepted %}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
            <span class="at-answer__accepted-icon">
                <svg id="answer{{ctx.answer.id}}_acc_svg"  xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="40" height="40" viewBox="0 0 20 20">
                    <path d="M8.294 16.998c-.435 0-.847-.203-1.111-.553L3.61 11.724a1.392 1.392 0 0 1 .27-1.951 1.392 1.392 0 0 1 1.953.27l2.351 3.104 5.911-9.492a1.396 1.396 0 0 1 1.921-.445c.653.406.854 1.266.446 1.92L9.478 16.34a1.39 1.39 0 0 1-1.12.656c-.022.002-.042.002-.064.002z"/>
                </svg>
            </span>
        {% endif%}
    </aside>
    <div class="at-answer__main">
        <div class="at-answer__content at-rich-content">
            {{ctx.answer.content|safe}}
        </div>
        <footer class="at-answer__meta {% if ctx.is_answer_author_question_owner %}at-answer__meta--author{% endif %}">       
            <span class="at-answer__time">
                answered <span class="datetime " data-dt="{{ ctx.answer.created_at|date:'c' }}">
                    {{ ctx.answer.created_at|date:"M d, Y H:i" }}
                </span>
            </span>
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-dot at-user-label" viewBox="0 0 16 16">
                <path d="M8 9.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3"/>
            </svg>    
            <span class="at-answer__author">
                <img class="at-avatar at-avatar-sm" src="{% if ctx.answer.author.profile_image %}{{ctx.answer.author.profile_image.url}}{% else %}{% static 'ask_together/img/default_profile.jpg' %}{% endif %}"/>
                <a href="{% url 'ask_together:user_profile' ctx.answer.author.id %}" class="at-answer__author-name"> 
                    {{ctx.answer.author.username}}
                </a>
            </span> 
        </footer>

        {% include 'ask_together/components/comments.html' with type="answer" id=ctx.answer.id first_comments=ctx.first_comments user=ctx.user has_more_comments=ctx.has_more_comments last_comment_id=ctx.last_comment_id %}
    </div>
</article>